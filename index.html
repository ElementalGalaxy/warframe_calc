<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warframe Damage Calculator</title>
    <style>
        #calc_containers {
            display: grid;
            grid-template-columns: repeat(4, 250px);
            gap: 10px 20px;
        }
        #calc_containers label {
            display: grid;
            grid-template-columns: minmax(150px, 1fr) auto;
            text-align: left;
        }
        #calc_containers input[type="number"] {
            width: 50px; 
            text-align: right;
        }
    </style>
</head>
<body>
    <h1>Warframe Damage Calculator</h1>


    <div id="calc_containers">
        <label><strong> Weapon's Base Stats</strong></label>
        <label><strong>Enter mod bonuses in %</strong></label>
        <label><strong>Final Stats</strong></label>
        <label><strong>Damage</strong></label>
        

        <label>Critical Chance<input type="number" id="weapon_crit_chance" placeholder="%" style="text-align: right;"></label>
        <label>Critical Chance Bonus<input type="number" id="crit_chance_bonus" placeholder="%" style="text-align: right;"></label>
        <label>Final Critical Chance<span id="final_crit_chance"></span></label>

        <label>Impact:<input type="number" id="impact_damage"></label>
            
        <label>Critical Multiplier/Damage <input type="number" id="weapon_crit_damage"></label>   
        <label>Critical Damage Bonus<input type="number" id="crit_damage_bonus" placeholder="%" style="text-align: right;"></label>
        <label>Final Critical Multiplier<span id="final_crit_damage"></span></label>

        <label>Puncture:<input type="number" id="puncture_damage"></label>
            
        <label>Fire Rate<input type="number" id="weapon_firerate"></label>  
        <label>Fire Rate Bonus<input type="number" id="firerate_bonus" placeholder="%" style="text-align: right;"></label>
        <label>Final Fire Rate<span id="final_firerate"></span></label>

        <label>Slash:<input type="number" id="slash_damage"></label>
            
        <label>Magazine Size<input type="number" id="weapon_magsize"></label>   
        <label>Magazine Bonus<input type="number" id="magsize_bonus" placeholder="%" style="text-align: right;"></label>
        <label>Final Magazine Size<span id="final_magsize"></span></label>

        <label>Base Elements:<input type="number" id="elemental_damage"></label>

        <label>Multishot<input type="number" id="weapon_multishot"></label>   
        <label>Multishot Bonus<input type="number" id="multishot_bonus" placeholder="%" style="text-align: right;"></label>
        <label>Final Multishot<span id="final_multishot"></span></label>

        <label>Radial/AOE Damage:<input type="number" id="radial_damage"></label>
            
        <label>Reload Speed<input type="number" id="weapon_reload_speed"></label>   
        <label>Reload Bonus<input type="number" id="reload_speed_bonus" placeholder="%" style="text-align: right;"></label>
        <label>Final Reload Speed<span id="final_reload_speed"></span></label>

        <label>Base Damage Bonus<input type="number" id="base_damage_bonus" placeholder="%" style="text-align: right;"></label>

        <label>Charge Time (if it has one)<input type="number" id="weapon_charge_time"></label> 
        <label>Effected by Fire Rate Mods <input type="number" placeholder="N/A"></label>
        <label>Final Charge Rate<span id="final_charge_rate"></span></label>

        <label>Multiplicative Gun/CO Bonus?<input type="checkbox" id="Gun/CO_checkbox"  onclick=calculateNums()></label>
        

        <label>Status Chance<input type="number" id="weapon_status_chance" placeholder="%" style="text-align: right;"></label>
        <label>Status Chance Bonus<input type="number" id="status_chance_bonus" placeholder="%" style="text-align: right;"></label>
        <label>Final Status Chance<span id="final_status_chance"></span></label>
        
        <label>Direct Damage Bonus<input type="number" id="direct_damage_bonus" placeholder="%" style="text-align: right;"></label>

        <label>Continious/Beam Weapon?<input type="checkbox" id="beam_weapon_checkbox"  onclick=calculateNums()></label>
        

        <label>Elemental Bonus<input type="number" id="elemental_bonus" placeholder="%" style="text-align: right;"></label>
        <label>Faction Bonus<input type="number" id="faction_bonus" placeholder="%" style="text-align: right;"></label>
          

    </div>
    <p>Base Damage: <span id="base_damage_output"></span></p>
    <p>Average Hit: <span id="average_damage_output"></span></p>
    <p>Burst DPS: <span id="burst_output"></span></p>
    <p>Sustained DPS: <span id="sustained_output"></span></p>


    <script>
        function calculateNums() 
        {   
            const allInputs = document.querySelectorAll('input[type="number"]');

            const stats = {};
            allInputs.forEach(input => {
                    stats[input.id] = Number(input.value);
                });
            console.log(stats)

            const impact_damage = stats.impact_damage;
            const puncture_damage = stats.puncture_damage;
            const slash_damage = stats.slash_damage;
            const aoe_damage = stats.radial_damage;
            const elemental_damage = stats.elemental_damage;

            let fire_rate = stats.weapon_firerate;
            let charge_rate = stats.weapon_charge_time;
            let magazine_size = stats.weapon_magsize;
            let reload_speed = stats.weapon_reload_speed;
            let crit_chance = stats.weapon_crit_chance;
            let crit_damage = stats.weapon_crit_damage;
            let multishot = stats.weapon_multishot;
            let status_chance = stats.weapon_status_chance;
            
            const base_damage_mods = stats.base_damage_bonus/100;
            const direct_damage_bonus = stats.direct_damage_bonus/100;
            const elemental_mods = stats.elemental_bonus/100;
            const faction_mods = stats.faction_bonus/100;
            const crit_chance_mods = stats.crit_chance_bonus/100;
            const crit_damage_mods = stats.crit_damage_bonus/100;
            const multishot_mods = stats.multishot_bonus/100;
            const firerate_mods = stats.firerate_bonus/100;
            const magazine_mods = stats.magsize_bonus/100;
            const reload_mods = stats.reload_speed_bonus/100;
            const status_chance_mods = stats.status_chance_bonus/100;

            crit_chance = (crit_chance /100) * (1+crit_chance_mods)
            crit_damage = crit_damage * (1+crit_damage_mods)
            multishot = multishot * (1+multishot_mods)
            fire_rate = fire_rate * (1+ firerate_mods)
            magazine_size = magazine_size * (1+magazine_mods)
            charge_rate = charge_rate/ (1+firerate_mods)
            reload_speed = reload_speed / (1+reload_mods)
            status_chance = (status_chance/100) * (1+ status_chance_mods)

            let effective_firerate = 1/(charge_rate+(1/fire_rate));
            let GunCO_checkbox = document.getElementById('Gun/CO_checkbox');
            if (GunCO_checkbox.checked) {
                base_total = (((slash_damage + puncture_damage + impact_damage + elemental_damage)*(1+direct_damage_bonus))+aoe_damage) * (1+base_damage_mods) * (1+elemental_mods) * (1+faction_mods) * multishot;
            }
            else {
                base_total = ((slash_damage + puncture_damage + impact_damage + elemental_damage)*(1+direct_damage_bonus+base_damage_mods))+(aoe_damage*(1+base_damage_mods)) * (1+elemental_mods) * (1+faction_mods) * multishot;
            }

            
            let chance_for_crit = (1+crit_chance*(crit_damage-1));
            let average_total = base_total * chance_for_crit;
            let burst_dps_total = average_total * effective_firerate;
            
            let beam_weapon = document.getElementById('beam_weapon_checkbox');
            if (beam_weapon.checked) {
                sustained_dps_total = burst_dps_total * ((magazine_size*2)/(effective_firerate*reload_speed+(magazine_size*2)));
            }
            else {
                sustained_dps_total = burst_dps_total * (magazine_size/(effective_firerate*reload_speed+magazine_size));
            }
            
            const final_crit_chance = document.getElementById('final_crit_chance');
                final_crit_chance.textContent = (crit_chance * 100).toFixed(0) + '%';
            const final_crit_damage = document.getElementById('final_crit_damage');
                final_crit_damage.textContent = crit_damage.toFixed(1);
            const final_multishot = document.getElementById('final_multishot');
                final_multishot.textContent = multishot.toFixed(1);
            const final_firerate = document.getElementById('final_firerate');
                final_firerate.textContent = fire_rate.toFixed(1);
            const final_magsize = document.getElementById('final_magsize');
                final_magsize.textContent = magazine_size.toFixed(0)
            const final_reload_speed = document.getElementById('final_reload_speed');
                final_reload_speed.textContent = reload_speed.toFixed(1)
            const final_charge_rate = document.getElementById('final_charge_rate');
                final_charge_rate.textContent = charge_rate.toFixed(0)
            const final_status_chance = document.getElementById('final_status_chance');
                final_status_chance.textContent = (status_chance * 100).toFixed(0) + '%';


            const base_Damage_OutputSpan = document.getElementById('base_damage_output');
                base_Damage_OutputSpan.textContent = base_total.toFixed(0);

            const average_Damage_OutputSpan = document.getElementById('average_damage_output');
                average_Damage_OutputSpan.textContent = average_total.toFixed(0);

            const burst_dps_output = document.getElementById('burst_output');
                burst_dps_output.textContent = burst_dps_total.toFixed(0);
            
            const sustained_dps_output = document.getElementById('sustained_output');
                sustained_dps_output.textContent = sustained_dps_total.toFixed(0);
        }

        const allInputs = document.querySelectorAll('input[type="number"]');
        allInputs.forEach(input => {
        input.addEventListener('input', calculateNums);
        });
    </script>
</body>
</html>
